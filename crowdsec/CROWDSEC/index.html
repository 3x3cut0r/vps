<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>CrowdSec - VPS - Virtual Privat Server</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "CrowdSec";
        var mkdocs_page_input_path = "crowdsec/CROWDSEC.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> VPS - Virtual Privat Server
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Startseite</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Index</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../docker/">docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nginx/">nginx</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../iot/">iot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../linux/">linux</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../opnsense/README.md">opnsense</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">proxmox</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../proxmox/">VPS/VDS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../proxmox/hm90/">Minisforum HM90</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">services</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../services/PIHOLE/">pihole</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../services/FREEPBX/">freepbx</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">VPS - Virtual Privat Server</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">CrowdSec</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="crowdsec">CrowdSec</h1>
<p>an open-source and participative security solution offering crowdsourced server detection and protection against malicious IPs.</p>
<h2 id="index">Index</h2>
<ol>
<li><a href="#install">Installation</a><br />
   0.1 <a href="#lapi">LAPI vs Collections vs Bouncer</a></li>
<li><a href="#collection">Collection</a><br />
   1.1 <a href="#sshd">sshd</a><br />
   1.2 <a href="#npm">npm</a></li>
<li><a href="#bouncer">Bouncer</a><br />
   2.1 <a href="#firewall-bouncer-iptables">firewall-bouncer-iptables</a></li>
<li><a href="#statistics">Statistics</a><br />
   3.1 <a href="#metrics">show metrics</a><br />
   3.2 <a href="#decisions">show decisions</a></li>
<li><a href="#machines">Add other machines to crowdsec LAPI on pve host</a><br />
   4.1 <a href="#lxc-110">Add lxc-110 (npm)</a></li>
</ol>
<p># <a href="#findme">Find Me</a><br />
# <a href="#license">License</a></p>
<h1 id="0-installation">0. Installation <a name="install"></a></h1>
<pre><code class="language-bash"># install on proxmox host and all LXC container to protect:
curl -s https://install.crowdsec.net | sudo sh
apt update
apt install crowdsec

# check installation
systemctl status crowdsec
cscli version
</code></pre>
<h3 id="01-lapi-vs-collections-vs-bouncer">0.1 LAPI vs Collections vs Bouncer <a name="lapi"></a></h3>
<p><strong>Local API (LAPI)</strong></p>
<ul>
<li>on the proxmox host as central management</li>
<li>receives alerts from collections</li>
<li>create and manage decisions</li>
<li>serve decisions to bouncers</li>
</ul>
<p><strong>Collection (Agent)</strong></p>
<ul>
<li>on a machine where an application produces logs (proxmox + lxc)</li>
<li>example collections: sshd, http ...</li>
</ul>
<p><strong>Bouncer</strong></p>
<ul>
<li>on a machine wherever you want to block traffic</li>
<li>enforce decisions created by the LAPI</li>
<li>connect to LAPI and pull ban list</li>
<li>apply ans using methods</li>
<li>example methods: iptables, nftables, ...</li>
</ul>
<h1 id="1-collection">1. Collection <a name="collection"></a></h1>
<p><strong>(Collection List)[https://app.crowdsec.net/hub/collections]</strong></p>
<h3 id="11-sshd">1.1 sshd <a name="sshd"></a></h3>
<pre><code class="language-bash"># install ssh collection
cscli collections install crowdsecurity/sshd
cscli hub update
systemctl reload crowdsec
</code></pre>
<h3 id="12-nginx-proxy-manager">1.2 nginx-proxy-manager <a name="npm"></a></h3>
<pre><code class="language-bash"># install nginx-proxy-manager collection
cscli collections install crowdsecurity/nginx-proxy-manager
cscli collections install crowdsecurity/http-cve
cscli collections install crowdsecurity/base-http-scenarios
cscli hub update
systemctl reload crowdsec
</code></pre>
<h1 id="2-bouncer">2. Bouncer <a name="bouncer"></a></h1>
<h3 id="21-firewall-bouncer-iptables">2.1 firewall-bouncer-iptables <a name="firewall-bouncer-iptables"></a></h3>
<pre><code class="language-bash"># install firewall-bouncer-iptables
apt install crowdsec-firewall-bouncer-iptables
</code></pre>
<h1 id="3-statistics">3. Statistics <a name="statistics"></a></h1>
<h3 id="31-show-metrics">3.1 show metrics <a name="metrics"></a></h3>
<pre><code class="language-bash"># show metrics
cscli metrics
</code></pre>
<h3 id="32-show-decisions">3.2 show decisions <a name="decisions"></a></h3>
<pre><code class="language-bash"># check decisions
cscli decisions list
</code></pre>
<h1 id="4-add-other-machines-to-crowdsec-lapi-on-pve-host">4. Add other machines to crowdsec LAPI on pve host <a name="machines"></a></h1>
<h3 id="41-add-lxc-110-npm">4.1 Add lxc-110 (npm) <a name="lxc-110"></a></h3>
<pre><code class="language-bash"># on proxmox: add machine lxc-110 (npm)
cscli machines add lxc-110 --auto --force
# check added machine
cscli machines list

# check your credentials
cat /etc/crowdsec/local_api_credentials.yaml

# to delete a machine
# cscli machines delete nginx-lxc-110

# on lxc-110
cat &gt;/etc/crowdsec/local_api_credentials.yaml &lt;&lt;EOF
url: http://192.168.40.1:8080/
login: lxc-110
password: &lt;PASSWORD&gt;
EOF
systemctl restart crowdsec.service
cscli lapi status
# expected output: You can successfully interact with Local API (LAPI)

# on proxmox
cscli machines list
# you should see lxc-110 on the list
</code></pre>
<h3 id="find-me">Find Me <a name="findme"></a></h3>
<p><img alt="E-Mail" src="https://img.shields.io/badge/E--Mail-executor55%40gmx.de-red" /></p>
<ul>
<li><a href="https://github.com/3x3cut0r">GitHub</a></li>
<li><a href="https://hub.docker.com/u/3x3cut0r">DockerHub</a></li>
</ul>
<h3 id="license">License <a name="license"></a></h3>
<p><a href="https://www.gnu.org/licenses/gpl-3.0"><img alt="License: GPL v3" src="https://img.shields.io/badge/License-GPLv3-blue.svg" /></a> - This project is licensed under the GNU General Public License - see the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">gpl-3.0</a> for details.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
